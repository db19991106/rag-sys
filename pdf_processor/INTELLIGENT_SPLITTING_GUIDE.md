# 智能切分功能使用指引

## 1. 功能介绍

智能切分是PDF文档智能处理系统的一项高级功能，能够根据文件类型自动选择最合适的切分策略，确保切分结果既保持内容的逻辑完整性，又符合后续处理的需求标准。

### 主要特点：
- **自动文件类型识别**：系统能够自动识别财务报表、合同、发票、报告、论文和报销单等常见文件类型
- **智能切分策略**：针对不同类型的文件采用不同的切分策略
- **参数可配置**：提供敏感度、最小/最大切分单元大小等参数设置
- **与现有策略兼容**：支持与基于大小、章节、页面的传统切分策略切换

## 2. 配置界面说明

智能切分功能的配置选项位于系统设置页面的"内容组织"标签页中。

### 访问路径：
1. 登录系统
2. 点击左侧导航栏的"设置"选项
3. 在设置页面中选择"内容组织"标签页

### 配置选项：

#### 基础设置
- **启用智能切分**：开启/关闭智能切分功能
- **切分策略**：选择切分策略，包括：
  - 智能切分 (推荐)
  - 基于大小
  - 基于章节
  - 基于页面

#### 智能切分参数
- **敏感度**：文件类型识别的敏感度，值越高识别越严格（范围：0.1-1.0，默认：0.6）
- **最小切分单元大小**：每个切分单元的最小字符数（范围：50-500，默认：100）
- **最大切分单元大小**：每个切分单元的最大字符数（范围：200-2000，默认：1000）
- **启用特殊规则**：开启/关闭针对特定文件类型的特殊切分规则

## 3. 参数设置详解

### 3.1 敏感度

敏感度参数控制文件类型识别的严格程度：
- **低敏感度** (0.1-0.4)：识别更宽松，可能会将边缘情况归类为特定文件类型
- **中等敏感度** (0.5-0.7)：平衡的识别策略，适合大多数场景
- **高敏感度** (0.8-1.0)：识别更严格，只有特征明显的文件才会被归类为特定类型

### 3.2 切分单元大小

- **最小切分单元大小**：确保每个切分单元至少包含指定数量的字符，避免产生过短的chunk
- **最大切分单元大小**：限制每个切分单元的最大字符数，确保chunk大小适中，便于后续处理

### 3.3 特殊规则

启用特殊规则后，系统会为特定类型的文件应用专门的切分规则：
- **财务报表**：优先保持表格的完整性
- **合同**：按照条款进行切分
- **发票**：按页面切分，确保每张发票作为独立chunk
- **报告**：按照章节结构切分
- **论文**：保持学术论文的结构完整性
- **报销单**：按表单字段和项目进行切分

## 4. 使用方法

### 4.1 基本使用流程

1. **配置智能切分参数**：在系统设置页面中设置智能切分的相关参数
2. **上传PDF文件**：通过系统的文件上传功能上传PDF文件
3. **启动处理**：点击处理按钮，系统会自动识别文件类型并应用相应的切分策略
4. **查看结果**：处理完成后，可以查看生成的chunk列表和详细内容

### 4.2 切换切分策略

如果需要临时切换切分策略：
1. 进入系统设置页面
2. 在"内容组织"标签页中选择所需的切分策略
3. 点击"保存设置"按钮
4. 重新上传文件进行处理

## 5. 最佳实践

### 5.1 不同文件类型的推荐配置

| 文件类型 | 推荐敏感度 | 最小切分单元 | 最大切分单元 | 特殊规则 |
|---------|-----------|-------------|-------------|----------|
| 财务报表 | 0.7 | 200 | 1000 | 启用 |
| 合同 | 0.6 | 300 | 800 | 启用 |
| 发票 | 0.8 | 100 | 500 | 启用 |
| 报告 | 0.5 | 250 | 900 | 启用 |
| 论文 | 0.6 | 300 | 1000 | 启用 |
| 报销单 | 0.7 | 150 | 600 | 启用 |
| 其他 | 0.5 | 100 | 800 | 禁用 |

### 5.2 性能优化建议

- **对于大型PDF文件**：适当增大最大切分单元大小，减少chunk数量
- **对于结构复杂的文件**：启用特殊规则，确保切分结果保持逻辑完整性
- **对于处理速度要求高的场景**：可以降低敏感度，提高识别速度

## 6. 故障排除

### 6.1 常见问题及解决方案

| 问题 | 可能原因 | 解决方案 |
|------|---------|----------|
| 文件类型识别错误 | 敏感度设置不当 | 调整敏感度参数，或手动选择切分策略 |
| 切分结果过于细碎 | 最大切分单元设置过小 | 增大最大切分单元大小 |
| 切分结果过于庞大 | 最大切分单元设置过大 | 减小最大切分单元大小 |
| 特殊规则不生效 | 未启用特殊规则 | 在配置中启用特殊规则 |
| 处理速度慢 | 文件过大或敏感度设置过高 | 优化文件大小，或降低敏感度 |

### 6.2 日志查看

如果遇到问题，可以查看系统日志获取详细信息：
- 日志文件路径：`pdf_processor_{timestamp}.log`
- 日志级别：INFO、ERROR、DEBUG
- 关键信息：文件类型识别结果、切分策略应用情况、处理时间等

## 7. 示例

### 7.1 报销单处理示例

**输入**：一张包含多个报销项目的报销单PDF

**处理过程**：
1. 系统识别为"报销单"类型
2. 应用报销单专用切分规则
3. 按照表单字段和报销项目进行切分

**输出**：
- 生成多个chunk，每个chunk对应一个报销项目或表单字段
- 保持表格的完整性
- 切分结果符合报销单的逻辑结构

### 7.2 财务报表处理示例

**输入**：一份包含资产负债表、利润表和现金流量表的财务报表PDF

**处理过程**：
1. 系统识别为"财务报表"类型
2. 应用财务报表专用切分规则
3. 按照报表类型和章节进行切分

**输出**：
- 生成多个chunk，每个chunk对应一个报表或报表的一个部分
- 保持表格的完整性
- 切分结果符合财务报表的结构特点

## 8. 总结

智能切分功能是PDF文档智能处理系统的一项重要增强，通过自动文件类型识别和智能切分策略，大大提高了系统的自动化水平和处理质量。合理配置参数并根据文件类型选择合适的切分策略，可以获得最佳的处理效果。

如果您在使用过程中遇到任何问题，请参考本指引的故障排除部分，或联系系统管理员获取帮助。
